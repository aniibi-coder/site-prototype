<!doctype html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ST9720GK2Y"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ST9720GK2Y');
</script>

<meta charset="utf-8" />

<!-- ===== FAVICONS ===== -->
<link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./assets/icons/favicon-16x16.png">
<link rel="icon" href="./assets/icons/favicon.ico" sizes="any">
<link rel="apple-touch-icon" href="./assets/icons/apple-touch-icon.png">
<meta name="theme-color" content="#080d16">
<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>Ridekit ‚Äî Gear Finder</title>
<meta name="description" content="Gear finder prototype for ski & snowboard: search items, filter by mountain, temperature and budget, and get a short packing list.">

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
/* ===== RIDEKIT ‚Äî GUIDED JOURNEY (LIGHT ALPINE) ===== */
:root{
  --bg: #eaf2ff;
  --bg2:#f7fbff;
  --text:#10223a;
  --muted:#4a607a;
  --dim:#6e84a0;

  --card: rgba(255,255,255,.62);
  --card2: rgba(255,255,255,.42);
  --stroke: rgba(255,255,255,.72);
  --stroke2: rgba(15,34,58,.12);

  --shadow: 0 18px 60px rgba(15,34,58,.14);
  --shadow2: 0 10px 30px rgba(15,34,58,.10);

  --primary:#2b6cff;
  --primary2:#3b86ff;
  --ice:#cfe5ff;
  --good:#1f9d57;
  --warn:#d18900;
  --bad:#c0392b;

  --radius: 18px;
  --radius2: 26px;
  --glassBlur: 14px;
  --max: 1500px;
}

*{box-sizing:border-box;margin:0;padding:0;}

body{
  margin:0;
  color:var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, "Noto Sans";
  background:
    radial-gradient(1200px 600px at 30% 0%, rgba(255,255,255,.70), rgba(255,255,255,0) 55%),
    radial-gradient(900px 500px at 80% 10%, rgba(207,229,255,.75), rgba(207,229,255,0) 60%),
    linear-gradient(180deg, #d6e9ff 0%, #f7fbff 35%, #e9f2ff 100%);
  min-height:100vh;
  overflow-x:hidden;
}

/* Optional background image: put a file at assets/bg/alpine.jpg */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image:url("./assets/bg/alpine.jpg");
  background-size:cover;
  background-position:center top;
  opacity:.16;
  pointer-events:none;
  z-index:-2;
}
body::after{
  content:"";
  position:fixed;
  inset:0;
  background: radial-gradient(900px 420px at 50% 0%, rgba(255,255,255,.75), rgba(255,255,255,0) 70%);
  pointer-events:none;
  z-index:-1;
}

.font-pixel{font-family:'Press Start 2P', monospace; letter-spacing:1px;}

@keyframes fadeInUp{from{opacity:0;transform:translateY(18px);}to{opacity:1;transform:translateY(0);}}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}

/* ===== SNOWFALL (subtle) ===== */
.snowfall{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:20;
  overflow:hidden;
  mix-blend-mode:screen;
  opacity:.45;
}
.snowflake{
  position:absolute;
  background:white;
  border-radius:50%;
  opacity:0;
  animation: fall linear infinite;
  filter: blur(.25px);
}
@keyframes fall{
  0%{opacity:0;transform:translateY(-10vh) translateX(0) rotate(0deg);} 
  10%{opacity:1;} 
  90%{opacity:.8;} 
  100%{opacity:0;transform:translateY(100vh) translateX(28px) rotate(360deg);} 
}

/* ===== HEADER (light glass) ===== */
header{
  height:64px;
  padding:0 18px;
  position:fixed; top:0; left:0; right:0; width:100%;
  z-index:10000;
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  gap:14px;
  background:rgba(255,255,255,.55);
  border-bottom:1px solid rgba(255,255,255,.65);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  box-shadow: 0 10px 35px rgba(15,34,58,.06);
  animation:fadeIn .35s ease-out;
}
.headerLeft{display:flex;align-items:center;gap:14px;min-width:0;}
.logo{display:flex;align-items:center;gap:10px;color:var(--text);text-decoration:none;}
.logo-icon{font-size:18px;}
.badge{
  font-size:12px;
  color:var(--muted);
  border:1px solid rgba(15,34,58,.12);
  padding:7px 12px;
  border-radius:999px;
  background:rgba(255,255,255,.35);
  white-space:nowrap;
}
.headerNav{display:flex;align-items:center;justify-content:center;gap:8px;}
.headerNav a{
  color:var(--muted);
  text-decoration:none;
  font-weight:700;
  font-size:13px;
  border:1px solid rgba(15,34,58,.12);
  padding:9px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.40);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: transform .18s ease, background .18s ease, border-color .18s ease, color .18s ease;
  display:flex;align-items:center;gap:8px;
}
.headerNav a:hover{color:var(--text);background:rgba(255,255,255,.60);transform:translateY(-1px);}
.headerNav a.active{color:var(--text);border-color:rgba(43,108,255,.25);background:rgba(43,108,255,.10);}
.headerRight{justify-self:end;}
.langSwitch{
  display:flex;align-items:center;gap:6px;
  padding:6px 8px;
  border:1px solid rgba(15,34,58,.12);
  border-radius:999px;
  background:rgba(255,255,255,.40);
  backdrop-filter: blur(10px);
}
.langIcon{font-size:13px;color:var(--muted);margin-right:2px;opacity:.9;}
.langBtn{
  border:1px solid transparent;background:transparent;color:var(--muted);
  padding:6px 10px;border-radius:999px;
  font-size:11px;font-weight:800;letter-spacing:.6px;
  cursor:pointer;transition:all .18s ease;font-family:inherit;
}
.langBtn:hover{color:var(--text);background:rgba(255,255,255,.65);border-color:rgba(15,34,58,.10);}
.langBtn.active{background:rgba(43,108,255,.12);border-color:rgba(43,108,255,.25);color:var(--text);}

@media (max-width: 900px){
  header{height:auto;grid-template-columns:1fr;padding:12px 14px;gap:12px;}
  .headerLeft{justify-content:center;flex-wrap:wrap;}
  .headerRight{justify-self:center;}
}

/* ===== PAGE LAYOUT ===== */
.wrap{
  padding-top:84px;
  max-width:var(--max);
  margin:0 auto;
  padding:84px 18px 18px;
  display:grid;
  grid-template-columns: 420px 1fr;
  gap:16px;
  align-items:start;
}
@media (max-width: 1050px){ .wrap{grid-template-columns:1fr;} }

.card{
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: var(--radius2);
  padding:20px;
  position:relative;
  overflow:hidden;
  box-shadow: var(--shadow2);
  backdrop-filter: blur(var(--glassBlur));
  -webkit-backdrop-filter: blur(var(--glassBlur));
  animation:fadeInUp .45s ease-out;
}
.card:hover{box-shadow:var(--shadow);}

.title{
  font-family:'Press Start 2P', monospace;
  font-size:13px;
  margin:0 0 10px 0;
  color:var(--text);
  text-transform:uppercase;
  letter-spacing:1px;
}
.muted{color:var(--muted);font-size:13px;}
.divider{height:1px;background:linear-gradient(90deg, transparent 0%, rgba(15,34,58,.18) 50%, transparent 100%);margin:16px 0;}

/* ===== HERO / STEPPER ===== */
.heroTitle{font-size:40px;line-height:1.05;letter-spacing:-.02em;margin:2px 0 6px 0;}
.heroSub{color:var(--muted);font-size:15px;margin:0;}
.stepper{
  margin-top:14px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  padding:10px;
  border-radius:999px;
  background:rgba(255,255,255,.40);
  border:1px solid rgba(255,255,255,.70);
}
.step{
  display:flex;align-items:center;gap:10px;
  padding:8px 12px;
  border-radius:999px;
  color:var(--muted);
  border:1px solid transparent;
}
.step .num{
  width:26px;height:26px;border-radius:999px;
  display:inline-flex;align-items:center;justify-content:center;
  background:rgba(15,34,58,.08);
  color:var(--muted);
  font-weight:800;
}
.step.on{background:rgba(43,108,255,.10);border-color:rgba(43,108,255,.18);color:var(--text);} 
.step.on .num{background:rgba(43,108,255,.18);color:var(--text);} 

/* ===== SEARCH / FILTER UI ===== */
.searchBar{
  display:flex; gap:10px; align-items:center;
  border:1px solid rgba(15,34,58,.12);
  background:rgba(255,255,255,.45);
  border-radius:16px;
  padding:10px 12px;
}
.searchBar input{
  flex:1;
  border:0; outline:0;
  background:transparent;
  color:var(--text);
  font-size:14px;
}
.searchBar input::placeholder{color:var(--dim);}
.searchBar .kbd{
  font-size:11px;
  color:var(--muted);
  border:1px solid rgba(15,34,58,.12);
  padding:4px 8px;
  border-radius:10px;
  background:rgba(255,255,255,.35);
}

.chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;}
.chip{
  border:1px solid rgba(15,34,58,.12);
  border-radius:999px;
  padding:7px 12px;
  font-size:12px;
  color:var(--muted);
  background:rgba(255,255,255,.45);
  cursor:pointer;
  display:inline-flex;align-items:center;gap:8px;
  transition:all .18s ease;
  user-select:none;
}
.chip:hover{background:rgba(255,255,255,.62);transform:translateY(-1px);}
.chip.active{color:var(--text);border-color:rgba(43,108,255,.25);background:rgba(43,108,255,.10);} 
.chip .x{
  width:18px;height:18px;border-radius:999px;
  border:1px solid rgba(15,34,58,.14);
  display:inline-flex;align-items:center;justify-content:center;
  font-weight:900;font-size:12px;
  color:rgba(16,34,58,.85);
  background:rgba(255,255,255,.40);
}

.bubbles{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;}
.bubble{
  border:1px solid rgba(15,34,58,.12);
  border-radius:999px;
  padding:6px 12px;
  font-size:12px;
  color:var(--muted);
  background:rgba(255,255,255,.35);
  cursor:pointer;
  transition:all .18s ease;
}
.bubble:hover{background:rgba(255,255,255,.55);transform:translateY(-1px);}
.bubble.on{color:var(--text);border-color:rgba(31,157,87,.28);background:rgba(31,157,87,.10);} 

.field{margin-top:14px;}
.labelRow{display:flex;justify-content:space-between;align-items:baseline;gap:10px;}
.labelRow label{font-weight:800;font-size:12px;color:var(--text);letter-spacing:.2px;}
.mini{font-size:12px;color:var(--muted);}
.rangeRow{margin-top:10px;}
input[type="range"]{width:100%;height:6px;border-radius:4px;background:rgba(15,34,58,.14);-webkit-appearance:none;appearance:none;cursor:pointer;}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--primary);box-shadow:0 0 0 6px rgba(43,108,255,.14);}
.moneyMarks{display:flex;justify-content:space-between;margin-top:8px;color:var(--muted);font-size:12px;}
.moneyMarks span{opacity:.55}
.moneyMarks span.on{opacity:1;color:var(--text);}

.tempBox{
  border:1px solid rgba(15,34,58,.12);
  border-radius:16px;
  padding:12px;
  background:rgba(255,255,255,.35);
  margin-top:10px;
}
.tempTopRow{display:flex;justify-content:space-between;gap:10px;align-items:center;}
.tempPill{border:1px solid rgba(15,34,58,.12);border-radius:999px;padding:6px 12px;background:rgba(255,255,255,.45);font-size:12px;color:var(--muted);} 
.tempPill b{color:var(--text);} 
.tempHint{margin-top:8px;font-size:12px;color:var(--muted);} 

.brandGrid{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;}
.brandBtn{
  border:1px solid rgba(15,34,58,.12);
  border-radius:999px;
  padding:7px 12px;
  font-size:12px;
  color:var(--muted);
  background:rgba(255,255,255,.45);
  cursor:pointer;
  transition:all .18s ease;
}
.brandBtn:hover{background:rgba(255,255,255,.62);transform:translateY(-1px);}
.brandBtn.on{color:var(--text);border-color:rgba(43,108,255,.25);background:rgba(43,108,255,.10);} 

/* ===== RESULTS ===== */
.resultsTop{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;}
.countPill{
  border:1px solid rgba(43,108,255,.25);
  background:rgba(43,108,255,.10);
  color:var(--text);
  border-radius:999px;
  padding:7px 12px;
  font-size:12px;
  font-weight:800;
}
.resultList{margin-top:12px;display:flex;flex-direction:column;gap:12px;}
.item{
  display:grid;
  grid-template-columns: 78px 1fr 160px;
  gap:14px;
  align-items:center;
  padding:14px;
  border:1px solid rgba(15,34,58,.12);
  border-radius:18px;
  background:rgba(255,255,255,.40);
  transition:transform .18s ease, box-shadow .18s ease, background .18s ease;
}
.item:hover{background:rgba(255,255,255,.60);transform:translateX(4px);box-shadow:var(--shadow2);} 
@media (max-width: 680px){ .item{grid-template-columns:1fr; text-align:center;} }
.thumb{
  width:78px;height:62px;
  border-radius:16px;
  border:1px solid rgba(15,34,58,.12);
  background:rgba(255,255,255,.55);
  display:flex;align-items:center;justify-content:center;
  overflow:hidden;
}
.thumb img{width:100%;height:100%;object-fit:contain;}
.item h4{margin:0 0 6px 0;font-size:14px;color:var(--text);font-weight:900;}
.tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px;}
.tag{font-size:11px;color:var(--muted);border:1px solid rgba(15,34,58,.12);padding:4px 8px;border-radius:999px;background:rgba(255,255,255,.35);} 
.item a.btn{
  display:inline-flex;align-items:center;justify-content:center;
  gap:8px;
  padding:12px 16px;
  border-radius:14px;
  background:linear-gradient(180deg, rgba(43,108,255,.90), rgba(43,108,255,.78));
  border:1px solid rgba(43,108,255,.25);
  color:white;
  text-decoration:none;
  font-weight:900;
  font-size:12px;
  transition:transform .18s ease, filter .18s ease;
}
.item a.btn:hover{transform:translateY(-2px);filter:brightness(1.05);} 
.item .note{font-size:12px;color:var(--muted);} 

/* ===== FOOTER ===== */
footer.siteFooter{margin-top:18px;padding:26px 16px;border-top:1px solid rgba(15,34,58,.12);background:rgba(255,255,255,.24);} 
.footerInner{max-width:var(--max);margin:0 auto;display:grid;grid-template-columns:1.2fr 1fr 1fr;gap:18px;align-items:start;} 
.footerBrand{display:flex;align-items:center;gap:10px;font-weight:900;color:var(--text);} 
.footerDesc{margin-top:10px;color:var(--muted);font-size:13px;line-height:1.5;max-width:520px;} 
.footerCol h4{margin:0 0 10px 0;font-size:12px;letter-spacing:.08em;text-transform:uppercase;color:var(--text);font-family:'Press Start 2P', monospace;} 
.footerLinks{display:flex;flex-direction:column;gap:8px;} 
.footerLinks a{color:var(--muted);text-decoration:none;font-size:13px;width:max-content;border-bottom:1px solid transparent;padding-bottom:2px;} 
.footerLinks a:hover{color:var(--text);border-bottom-color:rgba(43,108,255,.45);} 
.footerBottom{max-width:var(--max);margin:18px auto 0 auto;padding-top:14px;border-top:1px solid rgba(15,34,58,.12);display:flex;flex-wrap:wrap;gap:10px;justify-content:space-between;color:var(--muted);font-size:12px;} 
@media (max-width: 900px){ .footerInner{grid-template-columns:1fr;} }

.toast{
  position: fixed;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%) translateY(10px);
  background: rgba(255, 255, 255, 0.72);
  border: 1px solid rgba(15,34,58,.12);
  color: var(--text);
  padding: 10px 14px;
  border-radius: 14px;
  font-size: 12px;
  opacity: 0;
  pointer-events: none;
  transition: opacity .25s ease, transform .25s ease;
  z-index: 10000;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  box-shadow: var(--shadow2);
}
.toast.show{opacity:1;transform: translateX(-50%) translateY(0);}

/* ===== CALCULATOR (accordion) ===== */
details.rkCalc{ padding:0; }
details.rkCalc > summary{ list-style:none; cursor:pointer; user-select:none; outline:none; }
details.rkCalc > summary::-webkit-details-marker{ display:none; }

.rkAccSummary{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:18px 20px;
  border-bottom:1px solid rgba(15,34,58,.10);
  background: rgba(255,255,255,.20);
  border-radius:var(--radius2);
}
details.rkCalc[open] .rkAccSummary{ border-bottom-left-radius:0; border-bottom-right-radius:0; }
.rkAccChevron{font-size:14px;color:var(--muted);}
.rkAccBody{padding:18px 20px;}

.rkFormGrid{margin-top:14px;display:grid;grid-template-columns:repeat(3, minmax(0,1fr));gap:12px;}
@media (max-width: 1100px){ .rkFormGrid{grid-template-columns:repeat(2, minmax(0,1fr));} }
@media (max-width: 650px){ .rkFormGrid{grid-template-columns:1fr;} }

.rkField{display:flex;flex-direction:column;gap:8px;}
.rkLabelRow{display:flex;justify-content:space-between;gap:10px;align-items:baseline;}
.rkLabelRow label{font-weight:900;font-size:12px;}
.rkMini{font-size:12px;color:var(--muted);} 

.rkField input, .rkField select{
  width:100%;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(15,34,58,.12);
  background:rgba(255,255,255,.55);
  color:var(--text);
  outline:none;
}

.rkBtnRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px;}
.rkBtn{
  border:1px solid rgba(43,108,255,.25);
  background:linear-gradient(180deg, rgba(43,108,255,.90), rgba(43,108,255,.75));
  color:white;
  border-radius:14px;
  padding:10px 14px;
  font-weight:900;
  cursor:pointer;
}
.rkBtn.rkSecondary{background:rgba(255,255,255,.55);color:var(--text);border-color:rgba(15,34,58,.12);} 
.rkPill{border:1px solid rgba(15,34,58,.12);background:rgba(255,255,255,.45);padding:8px 10px;border-radius:999px;color:var(--muted);font-size:12px;} 

.rkResultGrid{display:grid;grid-template-columns:repeat(3, minmax(0,1fr));gap:12px;}
@media (max-width: 1100px){ .rkResultGrid{grid-template-columns:repeat(2, minmax(0,1fr));} }
@media (max-width: 650px){ .rkResultGrid{grid-template-columns:1fr;} }

.rkResultCard{border:1px solid rgba(15,34,58,.12);background:rgba(255,255,255,.45);border-radius:18px;padding:14px;} 
.rkResultCard h3{margin:0 0 6px 0;font-size:14px;} 
.rkResultCard p{margin:0;color:var(--muted);font-size:13px;} 

</style>
</head>

<body>

<div class="snowfall" id="snowfall" aria-hidden="true"></div>
<header>
  <div class="headerLeft">
    <a class="logo" href="index.html" style="text-decoration:none;">
      <span class="logo-icon">üèîÔ∏è</span>
      <span class="font-pixel" style="font-weight:900;">RIDEKIT.FR</span>
    </a>
    <div class="badge">Gear Finder</div>
  </div>

  <nav class="headerNav" aria-label="Pages">
    <a href="index.html" data-page="home">Map</a>
    <a href="gear.html" data-page="gear">Gear finder</a>
  </nav>

  <div class="headerRight">
    <div class="langSwitch" role="group" aria-label="Language selector">
      <span class="langIcon" aria-hidden="true">üåê</span>
      <button class="langBtn active" type="button" data-lang="en" aria-label="English">EN</button>
      <button class="langBtn" type="button" data-lang="fr" aria-label="Fran√ßais">FR</button>
      <button class="langBtn" type="button" data-lang="ru" aria-label="–†—É—Å—Å–∫–∏–π">RU</button>
      <button class="langBtn" type="button" data-lang="de" aria-label="Deutsch">DE</button>
    </div>
  </div>
</header>

<div class="wrap">

  <!-- HERO / PROGRESS -->
  <section class="card" aria-label="Gear Finder header" style="grid-column: 1 / -1;">
    <div>
      <h1 class="heroTitle">Gear Finder</h1>
      <p class="heroSub">Let‚Äôs find the gear that suits you best.</p>
    </div>

    <div class="stepper" aria-label="Progress steps">
      <div class="step"><span class="num">1</span><span>Destination</span></div>
      <div class="step"><span class="num">2</span><span>Weather</span></div>
      <div class="step"><span class="num">3</span><span>Skill level</span></div>
      <div class="step on"><span class="num">4</span><span>Your Gear</span></div>
    </div>
  </section>


  <!-- CALCULATOR (collapsible) -->
  <details class="card rkCalc accordion" id="calcCard" style="grid-column: 1 / -1;">
    <summary class="rkAccSummary" aria-controls="calcBody">
      <h2 class="title font-pixel" style="margin:0;">SKIS AND SNOWBOARDS SELECTION HELPER</h2>
      <span class="rkAccChevron" aria-hidden="true">‚ñæ</span>
    </summary>

    <div class="rkAccBody" id="calcBody">
      <div class="muted">This calculator helps people new to skiing and snowboarding to find matching equipment sizes.</div>

      <div class="rkFormGrid" aria-label="Sizing inputs">
        <div class="rkField">
          <div class="rkLabelRow">
            <label for="heightCm">Height (cm)</label>
            <span class="rkMini">e.g. 178</span>
          </div>
          <input id="heightCm" type="number" min="120" max="220" step="1" value="178" inputmode="numeric">
        </div>

        <div class="rkField">
          <div class="rkLabelRow">
            <label for="weightKg">Weight (kg)</label>
            <span class="rkMini">e.g. 75</span>
          </div>
          <input id="weightKg" type="number" min="35" max="150" step="1" value="75" inputmode="numeric">
        </div>

        <div class="rkField">
          <div class="rkLabelRow">
            <label for="ability">Ability</label>
            <span class="rkMini">controls length/flex</span>
          </div>
          <select id="ability">
            <option value="beginner">Beginner</option>
            <option value="intermediate" selected>Intermediate</option>
            <option value="advanced">Advanced</option>
          </select>
        </div>

        <div class="rkField">
          <div class="rkLabelRow">
            <label for="terrain">Terrain / style</label>
            <span class="rkMini">where you ride most</span>
          </div>
          <select id="terrain">
            <option value="allmountain" selected>All-mountain</option>
            <option value="piste">Mostly piste (groomers)</option>
            <option value="freeride">Freeride / powder</option>
            <option value="park">Park / freestyle</option>
          </select>
        </div>

        <div class="rkField">
          <div class="rkLabelRow">
            <label for="aggr">Riding feel</label>
            <span class="rkMini">relaxed vs aggressive</span>
          </div>
          <select id="aggr">
            <option value="relaxed">Relaxed</option>
            <option value="neutral" selected>Neutral</option>
            <option value="aggressive">Aggressive</option>
          </select>
        </div>

        <div class="rkField">
          <div class="rkLabelRow">
            <label for="boot">Boot size (EU) ‚Äî optional</label>
            <span class="rkMini">snowboard width hint</span>
          </div>
          <input id="boot" type="number" min="34" max="50" step="0.5" placeholder="e.g. 43">
        </div>
      </div>

      <div class="rkBtnRow">
        <button class="rkBtn" id="btnCalc" type="button">‚ú® Calculate</button>
        <button class="rkBtn rkSecondary" id="btnReset" type="button">‚Ü© Reset</button>
        <span class="rkPill" id="calcNote">Tip: tweak terrain to see different recommendations.</span>
      </div>

      <div class="divider"></div>

      <div class="rkResultGrid" id="resultGrid" aria-label="Sizing results">
        <!-- filled by JS -->
      </div>

      <div class="muted" style="margin-top:12px;font-size:13px;">
        Notes: Ski sizing mostly follows ‚Äúheight-based with adjustments‚Äù. Snowboard sizing is mainly weight-based, then adjusted for style. Always check the brand‚Äôs size chart.
      </div>
    </div>
  </details>

  <!-- LEFT: SEARCH / FILTERS -->
  <section class="card" aria-label="Search and filters">
    <h2 class="title font-pixel">SEARCH</h2>
    <div class="muted">Search anything (e.g. ‚Äúshell jacket‚Äù, ‚Äúgloves‚Äù, ‚Äúhelmet‚Äù). Use the chips like in your sketch.</div>

    <div class="searchBar" style="margin-top:12px;">
      <span aria-hidden="true">üîé</span>
      <input id="q" type="text" placeholder="Type here‚Ä¶" autocomplete="off">
      <span class="kbd" title="Keyboard shortcut">/</span>
    </div>

    <div class="chips" id="chipsRow" aria-label="Selected filters"></div>

    <div class="bubbles" aria-label="Recommended categories">
      <button class="bubble" type="button" data-bubble="pro">Pro</button>
      <button class="bubble" type="button" data-bubble="first">First experience</button>
      <button class="bubble" type="button" data-bubble="trip">Best for long trip</button>
      <button class="bubble" type="button" data-bubble="budget">Budget</button>
    </div>

    <div class="divider"></div>

    <h3 class="title font-pixel" style="font-size:13px;">MONEY</h3>
    <div class="field">
      <div class="labelRow">
        <label for="budget">Budget level</label>
        <span class="mini" id="budgetText">‚Ç¨‚Ç¨</span>
      </div>
      <div class="rangeRow">
        <input id="budget" type="range" min="1" max="3" step="1" value="2">
        <div class="moneyMarks">
          <span id="b1">‚Ç¨</span><span id="b2">‚Ç¨‚Ç¨</span><span id="b3">‚Ç¨‚Ç¨‚Ç¨</span>
        </div>
      </div>
    </div>

    <h3 class="title font-pixel" style="font-size:13px;margin-top:16px;">TEMPERATURE</h3>
    <div class="tempBox">
      <div class="tempTopRow">
        <div class="tempPill">Selected: <b id="selTemp">‚Äî</b></div>
        <div class="tempPill">Range: <b id="rngTemp">‚Äî</b></div>
      </div>
      <div class="rangeRow" style="margin-top:12px;">
        <input id="temp" type="range" min="-25" max="8" step="1" value="-8">
      </div>
      <div class="tempHint" id="tempHint">Tip: pick a mountain + day on the map page ‚Äî the temperature here will auto-fill.</div>
    </div>

    <h3 class="title font-pixel" style="font-size:13px;margin-top:16px;">FILTER</h3>
    <div class="muted">Brands (tap to toggle):</div>
    <div class="brandGrid" id="brands"></div>

    <div class="divider"></div>
    <div class="muted" style="font-size:12px;">
      ‚ö†Ô∏è Disclaimer: links are placeholders. Before monetization, add proper affiliate disclosure and use official affiliate links.
    </div>
  </section>

  <!-- RIGHT: RESULTS -->
  <section class="card" aria-label="Results">
    <div class="resultsTop">
      <div>
        <h2 class="title font-pixel">RESULTS</h2>
        <div class="muted" id="contextLine">No mountain selected yet.</div>
      </div>
      <div class="countPill" id="countPill">0 items</div>
    </div>

    <div class="resultList" id="list"></div>
  </section>
</div>

<footer class="siteFooter" role="contentinfo">
  <div class="footerInner">
    <div>
      <div class="footerBrand">
        <span style="filter: drop-shadow(0 0 10px rgba(42,109,255,0.35));">üèîÔ∏è</span>
        <span>RIDEKIT.FR</span>
      </div>
      <div class="footerDesc">
        A simple helper for choosing ski / snowboard gear based on weather and conditions.
        Always double‚Äëcheck real forecasts and avalanche bulletins before going to the mountains.
      </div>
    </div>

    <div class="footerCol">
      <h4>Navigation</h4>
      <div class="footerLinks">
        <a href="index.html">Resort map</a>
        <a href="gear.html">Gear finder</a>
      </div>
    </div>

    <div class="footerCol">
      <h4>Data & Sources</h4>
      <div class="footerLinks">
        <a href="https://open-meteo.com/" target="_blank" rel="noopener">Forecast: Open‚ÄëMeteo API</a>
        <a href="https://www.openstreetmap.org/" target="_blank" rel="noopener">Map: OpenStreetMap</a>
        <a href="privacy.html">Privacy policy</a>
      </div>
    </div>
  </div>

  <div class="footerBottom">
    <div>Made with ‚ù§Ô∏è for snowy adventures</div>
    <div>¬© 2026 RIDEKIT. All rights reserved.</div>
  </div>
</footer>

<div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
// ===== SNOWFALL EFFECT (visual only) =====
function createSnowfall() {
  const container = document.getElementById('snowfall');
  if (!container) return;
  container.innerHTML = "";
  const count = 60;

  for (let i = 0; i < count; i++) {
    const flake = document.createElement('div');
    flake.className = 'snowflake';
    flake.style.left = Math.random() * 100 + '%';
    const size = (2 + Math.random() * 4);
    flake.style.width = size + 'px';
    flake.style.height = size + 'px';
    flake.style.animationDuration = (8 + Math.random() * 12) + 's';
    flake.style.animationDelay = (Math.random() * 10) + 's';
    flake.style.opacity = (0.25 + Math.random() * 0.65).toFixed(2);
    container.appendChild(flake);
  }
}
createSnowfall();


/* ===== header active link ===== */
(function(){
  const path = (location.pathname || "").toLowerCase();
  const isGear = path.endsWith("/gear.html") || path.endsWith("gear.html");
  const homeLink = document.querySelector('.headerNav a[data-page="home"]');
  const gearLink = document.querySelector('.headerNav a[data-page="gear"]');
  if (!homeLink || !gearLink) return;
  (isGear ? gearLink : homeLink).classList.add("active");
})();

/* ===== language switch (placeholder, same behavior as index) ===== */
(function(){
  const STORAGE_KEY = "mml_lang";
  const btns = Array.from(document.querySelectorAll(".langBtn[data-lang]"));
  if (!btns.length) return;
  function normalize(lang){
    lang=(lang||"").toString().toLowerCase();
    if (lang.startsWith("en")) return "en";
    if (lang.startsWith("fr")) return "fr";
    if (lang.startsWith("ru")) return "ru";
    if (lang.startsWith("de")) return "de";
    return "en";
  }
  function showToast(msg){
    const t = document.getElementById("toast");
    t.textContent = msg;
    t.classList.add("show");
    clearTimeout(t._hideTimer);
    t._hideTimer = setTimeout(()=>t.classList.remove("show"), 2200);
  }
  function setLang(code, persist){
    const c = normalize(code);
    document.documentElement.setAttribute("lang", c);
    document.documentElement.dataset.lang = c;
    btns.forEach(b => b.classList.toggle("active", b.dataset.lang === c));
    if (persist) localStorage.setItem(STORAGE_KEY, c);
    showToast(`Language: ${c.toUpperCase()} (translations coming soon)`);
  }
  const saved = localStorage.getItem(STORAGE_KEY);
  const auto = normalize(navigator.language || navigator.userLanguage || "");
  setLang(saved || auto, false);
  btns.forEach(b => b.addEventListener("click", ()=> setLang(b.dataset.lang, true)));
})();

/* ===== Search menu logic (filters + list) ===== */
const RK_SEL_KEY = "rk_selection_v1";

let GEAR_DB = []; // loaded from gear-data.json

const ALLOWED_BUBBLES = new Set(["pro","first","trip","budget"]);

function sanitizeStateAfterLoad(){
  // Remove stale stored brands that no longer exist
  const brandSet = new Set(GEAR_DB.map(x=>x.brand));
  state.brands = new Set(Array.from(state.brands).filter(b => brandSet.has(b)));

  // Remove stale bubbles
  state.bubbles = new Set(Array.from(state.bubbles).filter(b => ALLOWED_BUBBLES.has(b)));

  // Remove stale variant selections
  const itemIds = new Set(GEAR_DB.map(x=>x.id));
  for (const k of Object.keys(state.variantByItem || {})){
    if (!itemIds.has(k)) delete state.variantByItem[k];
  }

  // Clamp numeric controls
  state.budget = Math.min(3, Math.max(1, parseInt(state.budget, 10) || 2));
  state.tempC = Math.round(parseInt(state.tempC, 10) || -8);
}


async function loadGearDB(){
  // Keep gear-data.json in the SAME folder as gear.html
  const url = "./gear-data.json";
  const res = await fetch(url, { cache: "no-store" });
  if (!res.ok) throw new Error(`Failed to load ${url} (${res.status})`);
  const data = await res.json();
  if (!Array.isArray(data)) throw new Error("gear-data.json must be an array");
  GEAR_DB = data;
}


const state = {
  q: "",
  budget: 2,
  tempC: -8,
  bubbles: new Set(),
  variantByItem: {}, // { [itemId]: variantId }
 // "pro" | "first" | "trip" | "budget"
  brands: new Set(),
  selection: null
};

const RK_UI_KEY = "rk_gear_ui_v1";

function loadUiState(){
  try{
    const raw = localStorage.getItem(RK_UI_KEY);
    if (!raw) return;
    const s = JSON.parse(raw);
    if (typeof s.q === "string") state.q = s.q;
    if (Number.isFinite(s.budget)) state.budget = Math.min(3, Math.max(1, s.budget));
    if (Number.isFinite(s.tempC)) state.tempC = Math.round(s.tempC);
    if (Array.isArray(s.bubbles)) state.bubbles = new Set(s.bubbles);
    if (Array.isArray(s.brands)) state.brands = new Set(s.brands);
    if (s.variantByItem && typeof s.variantByItem === "object") state.variantByItem = s.variantByItem;
  }catch(e){}
}

function saveUiState(){
  try{
    const payload = {
      q: state.q,
      budget: state.budget,
      tempC: state.tempC,
      bubbles: Array.from(state.bubbles),
      brands: Array.from(state.brands),
      variantByItem: state.variantByItem
    };
    localStorage.setItem(RK_UI_KEY, JSON.stringify(payload));
  }catch(e){}
}

const els = {
  q: document.getElementById("q"),
  chipsRow: document.getElementById("chipsRow"),
  budget: document.getElementById("budget"),
  budgetText: document.getElementById("budgetText"),
  b1: document.getElementById("b1"),
  b2: document.getElementById("b2"),
  b3: document.getElementById("b3"),
  temp: document.getElementById("temp"),
  selTemp: document.getElementById("selTemp"),
  rngTemp: document.getElementById("rngTemp"),
  tempHint: document.getElementById("tempHint"),
  brands: document.getElementById("brands"),
  contextLine: document.getElementById("contextLine"),
  list: document.getElementById("list"),
  countPill: document.getElementById("countPill"),
};

function moneyText(n){ return n===1 ? "‚Ç¨" : (n===2 ? "‚Ç¨‚Ç¨" : "‚Ç¨‚Ç¨‚Ç¨"); }

function readSelection(){
  try{
    const raw = localStorage.getItem(RK_SEL_KEY);
    if (!raw) return null;
    return JSON.parse(raw);
  }catch(e){ return null; }
}

function clearSelection(){
  try{ localStorage.removeItem(RK_SEL_KEY); }catch(e){}
  state.selection = null;
  paintChips();
  paintContext();
  render();
}

function resetAll(){
  state.q = "";
  state.budget = 2;
  state.tempC = -8;
  state.bubbles = new Set();
  state.brands = new Set();
  state.variantByItem = {};
  try{ localStorage.removeItem(RK_UI_KEY); }catch(e){}
  // keep mountain selection (doesn't hurt)
  els.q.value = "";
  els.budget.value = state.budget;
  els.temp.value = state.tempC;
  document.querySelectorAll(".bubble").forEach(b=>b.classList.remove("on"));
  buildBrandButtons();
  paintBudget();
  paintTemp();
  saveUiState();
  render();
}


function paintContext(){
  const s = state.selection;
  if (!s || !s.name){
    els.contextLine.textContent = "No mountain selected yet. Go to Map ‚Üí pick a mountain.";
    return;
  }
  const day = s.date ? ` ‚Ä¢ ${s.date}` : "";
  const tmin = (typeof s.tmin === "number") ? Math.round(s.tmin) : null;
  const tmax = (typeof s.tmax === "number") ? Math.round(s.tmax) : null;
  const tr = (tmin!=null && tmax!=null) ? ` ‚Ä¢ ${tmax}¬∞ / ${tmin}¬∞` : "";
  els.contextLine.textContent = `${s.name} (${s.region})${day}${tr}`;
}

function chip(label, active, onClick, allowX=false, onX=null){
  const b = document.createElement("button");
  b.type="button";
  b.className = "chip" + (active ? " active" : "");
  b.textContent = label;
  b.addEventListener("click", onClick);

  if (allowX){
    const x = document.createElement("span");
    x.className = "x";
    x.textContent = "√ó";
    x.title = "Clear";
    x.addEventListener("click", (e)=>{ e.stopPropagation(); onX && onX(); });
    b.appendChild(x);
  }
  return b;
}

function paintChips(){
  els.chipsRow.innerHTML = "";
  const sel = state.selection;

  // Selected mountain chip (glows if selected)
  if (sel && sel.name){
    els.chipsRow.appendChild(
      chip(`Selected mountain: ${sel.name}`, true, ()=>{ location.href="index.html"; }, true, clearSelection)
    );
  }else{
    els.chipsRow.appendChild(
      chip("Selected mountain", false, ()=>{ location.href="index.html"; })
    );
  }

  // Selected section (placeholder)
  els.chipsRow.appendChild(
    chip("Selected section", state.bubbles.has("trip"), ()=> toggleBubble("trip"))
  );
}

function paintBudget(){
  els.budgetText.textContent = moneyText(state.budget);
  els.b1.classList.toggle("on", state.budget===1);
  els.b2.classList.toggle("on", state.budget===2);
  els.b3.classList.toggle("on", state.budget===3);
}

function paintTemp(){
  els.selTemp.textContent = `${state.tempC}¬∞C`;
  const s = state.selection;
  const tmin = (s && typeof s.tmin === "number") ? Math.round(s.tmin) : null;
  const tmax = (s && typeof s.tmax === "number") ? Math.round(s.tmax) : null;

  if (tmin!=null && tmax!=null){
    els.rngTemp.textContent = `${tmax}¬∞ / ${tmin}¬∞`;
    els.tempHint.textContent = "Auto-filled from the selected mountain/day on the map page.";
  }else{
    els.rngTemp.textContent = "‚Äî";
    els.tempHint.textContent = "Tip: pick a mountain + day on the map page ‚Äî the temperature here will auto-fill.";
  }
}

function toggleBubble(k){
  if (state.bubbles.has(k)) state.bubbles.delete(k);
  else state.bubbles.add(k);
  document.querySelectorAll(".bubble").forEach(b=>{
    b.classList.toggle("on", state.bubbles.has(b.dataset.bubble));
  });
  // convenience: if user clicks "budget" bubble, set budget to ‚Ç¨
  if (k==="budget" && state.bubbles.has("budget")) state.budget = 1;
  paintBudget();
  saveUiState();
  render();
}

function buildBrandButtons(){
  const brands = Array.from(new Set(GEAR_DB.map(x=>x.brand))).sort();
  els.brands.innerHTML = "";
  brands.forEach(br=>{
    const b = document.createElement("button");
    b.type="button";
    b.className = "brandBtn" + (state.brands.has(br) ? " on" : "");
    b.textContent = br;
    b.addEventListener("click", ()=>{
      if (state.brands.has(br)) state.brands.delete(br);
      else state.brands.add(br);
      b.classList.toggle("on", state.brands.has(br));
      saveUiState();
      render();
    });
    els.brands.appendChild(b);
  });
}

function matchItem(it){
  const q = (state.q || "").trim().toLowerCase();
  if (q){
    const hay = `${it.title} ${it.brand} ${it.tags.join(" ")}`.toLowerCase();
    if (!hay.includes(q)) return false;
  }

  if (state.brands.size && !state.brands.has(it.brand)) return false;

  // budget: item must be <= selected budget
  if (it.budget > state.budget) return false;

  // temp: for clothing we check range; for hardgoods (helmet/goggles/skis/etc.) tempIndependent = true
  if (!it.tempIndependent){
    if (typeof it.tempMin === "number" && state.tempC < it.tempMin) return false;
    if (typeof it.tempMax === "number" && state.tempC > it.tempMax) return false;
  }

  // bubbles: require corresponding tags
  for (const b of state.bubbles){
    if (b === "budget") continue; // budget already handled
    if (!it.tags.includes(b)) return false;
  }
  return true;
}

function render(){
  paintContext();
  paintTemp();
  paintBudget();

  const out = GEAR_DB.filter(matchItem);
  els.countPill.textContent = `${out.length} items`;
  
  els.list.innerHTML = out.map(it => {
    const tags = it.tags.map(t=>`<span class="tag">${t}</span>`).join("");

    // variant (optional)
    let variant = null;
    if (Array.isArray(it.variants) && it.variants.length){
      const chosen = state.variantByItem[it.id];
      variant = it.variants.find(v=>v.id===chosen) || it.variants[0];
    }

    const tMin = (variant && typeof variant.tempMin === "number") ? variant.tempMin : it.tempMin;
    const tMax = (variant && typeof variant.tempMax === "number") ? variant.tempMax : it.tempMax;

    const tempTxt = it.tempIndependent
      ? "Always"
      : (typeof tMin === "number" || typeof tMax === "number")
          ? `Works around ${typeof tMin==="number"?tMin:"?"}..${typeof tMax==="number"?tMax:"?"}¬∞C`
          : "Temp: n/a";

    const budgetTxt = "‚Ç¨".repeat(it.budget) + `<span class="muted">` + "‚Ç¨".repeat(Math.max(0, 3-it.budget)) + `</span>`;
    const link = (variant && variant.link) ? variant.link : it.link || "#";

    const variantUI = (variant)
      ? `
        <div class="note" style="margin-top:8px;">
          <label class="muted" for="var_${it.id}" style="display:block;margin-bottom:4px;">Options</label>
          <select class="rkSelect" id="var_${it.id}" data-variant="1" data-item="${it.id}">
            ${it.variants.map(v=>`<option value="${v.id}" ${v.id===variant.id?"selected":""}>${v.label}</option>`).join("")}
          </select>
        </div>
      `
      : "";

    return `
      <div class="item">
        <div class="thumb" aria-hidden="true">${it.emoji}</div>
        <div>
          <h4>${it.title}</h4>
          <div class="note"><b>${it.brand}</b> ‚Ä¢ Budget: ${budgetTxt} ‚Ä¢ <span class="muted">${tempTxt}</span></div>
          <div class="tags">${tags}</div>
          <div class="note" style="margin-top:6px;">${it.note}</div>
          ${variantUI}
        </div>
        <div style="display:flex;justify-content:flex-end;gap:10px;align-items:flex-start;">
          <a class="btn" href="${link}" target="_blank" rel="noopener">Open ‚Üí</a>
        </div>
      </div>
    `;
  }).join("") || (() => {
    const hasFilters = (state.q && state.q.trim()) || state.brands.size || state.bubbles.size || (state.budget !== 3) || false;
    if (!hasFilters){
      return `
        <div class="muted" style="margin-top:8px;">
          No items to show. If you just updated files, hard refresh (Ctrl+F5) and make sure <code>gear-data.json</code> is next to <code>gear.html</code>.
        </div>
      `;
    }
    return `
      <div class="muted" style="margin-top:8px;">
        No matches. Try removing some filters or increasing the budget.
        <div style="margin-top:10px;">
          <button class="rkBtn rkSecondary" type="button" id="btnResetFilters">Reset filters</button>
        </div>
      </div>
    `;
  })();
}

function wire(){
// keyboard shortcut for search
  document.addEventListener("keydown", (e)=>{
    if (e.key === "/" && document.activeElement !== els.q){
      e.preventDefault();
      els.q.focus();
    }
  });

  els.q.addEventListener("input", ()=>{ state.q = els.q.value; saveUiState(); render(); });
  els.budget.addEventListener("input", ()=>{
    state.budget = parseInt(els.budget.value, 10);
    paintBudget();
    saveUiState();
    render();
  });
  els.temp.addEventListener("input", ()=>{
    state.tempC = parseInt(els.temp.value, 10);
    saveUiState();
    render();
  });

  document.querySelectorAll(".bubble").forEach(b=>{
    b.addEventListener("click", ()=> toggleBubble(b.dataset.bubble));
  });

  buildBrandButtons();
  paintChips();
  paintBudget();
  paintTemp();
  render();

  // reset filters button (appears in empty state)
  els.list.addEventListener('click', (e)=>{
    const t = e.target;
    if (t && t.id === 'btnResetFilters') resetAll();
  });

  // variant selectors inside cards
  els.list.addEventListener("change", (e)=>{
    const t = e.target;
    if (!(t && t.matches && t.matches("select[data-variant][data-item]"))) return;
    const itemId = t.getAttribute("data-item");
    state.variantByItem[itemId] = t.value;
    saveUiState();
    render();
  });

}

(async function init(){
  state.selection = readSelection();
  loadUiState();

  // If we have selection from index, auto-set temp from it
  if (state.selection && typeof state.selection.tempC === "number"){
    state.tempC = Math.round(state.selection.tempC);
  }

  // Reflect to UI controls
  els.temp.value = state.tempC;
  els.budget.value = state.budget;
  els.q.value = state.q;

  try{
    await loadGearDB();
    sanitizeStateAfterLoad();
  }catch(err){
    console.error(err);
    els.list.innerHTML = `
      <div class="muted" style="margin-top:8px;">
        <b>Could not load gear-data.json.</b><br/>
        Put <code>gear-data.json</code> next to <code>gear.html</code> (same folder) and ensure it‚Äôs valid JSON.
      </div>
    `;
    els.countPill.textContent = "0 items";
  }

  wire();
})();

/* ===== Collapsible calculator (remember open/closed) ===== */
(function(){
  const det = document.getElementById("calcCard");
  if (!det) return;
  const key = "rk_calc_open";
  const sum = det.querySelector("summary");
  function sync(){
    if (sum) sum.setAttribute("aria-expanded", det.open ? "true" : "false");
  }
  try{
    const saved = localStorage.getItem(key);
    if (saved === "1") det.open = true;
    if (saved === "0") det.open = false;
  }catch(e){}
  sync();
  det.addEventListener("toggle", () => {
    sync();
    try{ localStorage.setItem(key, det.open ? "1" : "0"); }catch(e){}
  });
})();

/* ===== Calculator logic (simple heuristics) ===== */
function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }
function round5(x){ return Math.round(x / 5) * 5; }

function skiLengthRange(heightCm, ability, terrain, aggr){
  let base = heightCm * 0.90;
  const terrAdj = { park:-8, piste:-3, allmountain:0, freeride:+6 }[terrain] ?? 0;
  const abilAdj = { beginner:-8, intermediate:0, advanced:+6 }[ability] ?? 0;
  const aggrAdj = { relaxed:-3, neutral:0, aggressive:+4 }[aggr] ?? 0;

  let center = base + terrAdj + abilAdj + aggrAdj;
  center = clamp(center, heightCm - 25, heightCm + 10);

  const range = (ability === "beginner") ? 10 : (ability === "advanced") ? 12 : 10;
  const minLen = round5(center - range/2);
  const maxLen = round5(center + range/2);
  return { minLen, maxLen, center: round5(center) };
}

function skiType(terrain){
  if (terrain === "park") return "Freestyle / Twin-tip";
  if (terrain === "piste") return "Piste / Carving";
  if (terrain === "freeride") return "Freeride / Powder";
  return "All-mountain";
}

function snowboardLengthByWeight(weightKg){
  if (weightKg < 45) return { min: 135, max: 145 };
  if (weightKg < 55) return { min: 140, max: 150 };
  if (weightKg < 65) return { min: 146, max: 155 };
  if (weightKg < 75) return { min: 150, max: 159 };
  if (weightKg < 85) return { min: 154, max: 162 };
  if (weightKg < 95) return { min: 158, max: 166 };
  return { min: 160, max: 170 };
}

function snowboardAdjust(range, terrain, ability, aggr){
  let min = range.min, max = range.max;
  if (terrain === "park") { min -= 3; max -= 3; }
  if (terrain === "piste") { min -= 1; max -= 1; }
  if (terrain === "freeride") { min += 3; max += 3; }
  if (ability === "beginner") { min -= 2; max -= 2; }
  if (ability === "advanced") { min += 2; max += 2; }
  if (aggr === "aggressive") { min += 1; max += 1; }
  if (aggr === "relaxed") { min -= 1; max -= 1; }

  min = clamp(min, 130, 175);
  max = clamp(max, 132, 178);

  const center = round5((min + max) / 2);
  return { min: round5(min), max: round5(max), center };
}

function snowboardShape(terrain){
  if (terrain === "park") return "True twin / directional twin";
  if (terrain === "freeride") return "Directional (setback) / tapered";
  return "Directional twin / all-mountain";
}

function flexSuggestion(ability, terrain, aggr){
  let flex = 5;
  if (terrain === "park") flex -= 1;
  if (terrain === "freeride") flex += 1;
  if (ability === "beginner") flex -= 2;
  if (ability === "advanced") flex += 1;
  if (aggr === "aggressive") flex += 1;
  if (aggr === "relaxed") flex -= 1;
  flex = clamp(flex, 2, 8);
  const label = (flex <= 3) ? "Soft" : (flex <= 5) ? "Medium" : "Stiff-ish";
  return { flex, label };
}

function widthHint(bootEU){
  if (!bootEU || !isFinite(bootEU)) return "Width: standard (check boot chart)";
  if (bootEU >= 45) return "Width: Wide (for big boots)";
  if (bootEU >= 42.5) return "Width: Mid-wide / Wide depending on brand";
  return "Width: standard";
}

function renderResults(){
  const height = parseFloat(document.getElementById("heightCm")?.value);
  const weight = parseFloat(document.getElementById("weightKg")?.value);
  const ability = document.getElementById("ability")?.value;
  const terrain = document.getElementById("terrain")?.value;
  const aggr = document.getElementById("aggr")?.value;
  const boot = parseFloat(document.getElementById("boot")?.value);

  const grid = document.getElementById("resultGrid");
  if (!grid) return;

  if (!isFinite(height) || !isFinite(weight) || height < 120 || weight < 35){
    grid.innerHTML = `
      <div class="rkResultCard">
        <div class="muted">Please enter valid height + weight.</div>
      </div>
    `;
    return;
  }

  const ski = skiLengthRange(height, ability, terrain, aggr);
  const snowBase = snowboardLengthByWeight(weight);
  const board = snowboardAdjust(snowBase, terrain, ability, aggr);
  const flex = flexSuggestion(ability, terrain, aggr);

  const skiTxt = skiType(terrain);
  const boardShapeTxt = snowboardShape(terrain);
  const wHint = widthHint(boot);

  grid.innerHTML = `
    <div class="rkResultCard">
      <div class="rkResultTop">
        <div>
          <b>üéø Skis</b>
          <div class="rkSub">${skiTxt}</div>
        </div>
        <span class="rkPill rkPillIce">${ability}</span>
      </div>
      <div class="rkBig">${ski.minLen}‚Äì${ski.maxLen} cm</div>
      <div class="rkSub">
        Center: <b>${ski.center} cm</b><br/>
        Tip: quick turns ‚Üí closer to ${ski.minLen}; stability ‚Üí closer to ${ski.maxLen}.
      </div>
    </div>

    <div class="rkResultCard">
      <div class="rkResultTop">
        <div>
          <b>üèÇ Snowboard</b>
          <div class="rkSub">${boardShapeTxt}</div>
        </div>
        <span class="rkPill rkPillIce">${aggr}</span>
      </div>
      <div class="rkBig">${board.min}‚Äì${board.max} cm</div>
      <div class="rkSub">
        Center: <b>${board.center} cm</b><br/>
        Flex: <b>${flex.label}</b> (${flex.flex}/10)<br/>
        ${wHint}
      </div>
    </div>
  `;
}

document.getElementById("btnCalc")?.addEventListener("click", renderResults);
document.getElementById("btnReset")?.addEventListener("click", () => {
  document.getElementById("heightCm").value = 178;
  document.getElementById("weightKg").value = 75;
  document.getElementById("ability").value = "intermediate";
  document.getElementById("terrain").value = "allmountain";
  document.getElementById("aggr").value = "neutral";
  document.getElementById("boot").value = "";
  renderResults();
});

["heightCm","weightKg","ability","terrain","aggr","boot"].forEach(id => {
  const el = document.getElementById(id);
  el?.addEventListener("input", renderResults);
  el?.addEventListener("change", renderResults);
});

</script>
</body>
</html>





























