<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meow Meow Land ‚Äî Gear Finder</title>

  <!-- Fonts (same as main page) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    /* ===== WINTER ALPINE DESIGN SYSTEM (copied style spirit from index) ===== */
    :root{
      --bg:#080d16;
      --bg-secondary:#0c1221;
      --card:#101828;
      --card-hover:#151f35;

      --text:#eaf4ff;
      --text-muted:#8ba4c7;
      --text-dim:#5a7299;

      --ice:#38bdf8;
      --ice-glow:#7dd3fc;
      --frost:#a5f3fc;
      --aurora-blue:#2563eb;
      --aurora-purple:#8b5cf6;
      --aurora-pink:#ec4899;
      --snow:#f0f9ff;
      --green-glow:#4ade80;

      --line:#1e3a5f;
      --line-light:#2a4a70;
      --glass-border: rgba(56,189,248,.15);

      --shadow-glow: 0 0 40px rgba(56,189,248,.15);
      --shadow-frost: 0 8px 32px rgba(8,13,22,.8);
      --gradient-aurora: linear-gradient(135deg, rgba(139,92,246,.15) 0%, rgba(236,72,153,.10) 50%, rgba(56,189,248,.15) 100%);
      --gradient-card: linear-gradient(135deg, rgba(16,24,40,.9) 0%, rgba(12,18,33,.95) 100%);
    }

    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      font-family:'Inter',system-ui,-apple-system,sans-serif;
      background:var(--bg);
      color:var(--text);
      overflow-y:auto;
      line-height:1.5;
      -webkit-font-smoothing:antialiased;
    }
    .font-pixel{ font-family:'Press Start 2P',monospace; letter-spacing:1px; }

    /* ===== SNOWFALL ===== */
    .snowfall{
      position:fixed; inset:0;
      pointer-events:none;
      z-index:20;
      overflow:hidden;
      mix-blend-mode:screen;
      opacity:.7;
    }
    .snowflake{
      position:absolute;
      background:white;
      border-radius:50%;
      opacity:0;
      animation:fall linear infinite;
      filter: blur(.2px);
    }
    @keyframes fall{
      0%{ opacity:0; transform: translateY(-10vh) translateX(0) rotate(0deg);}
      10%{opacity:1;}
      90%{opacity:.8;}
      100%{ opacity:0; transform: translateY(100vh) translateX(30px) rotate(360deg);}
    }

    /* ===== ANIM ===== */
    @keyframes fadeInUp{ from{opacity:0; transform: translateY(30px);} to{opacity:1; transform: translateY(0);} }
    @keyframes fadeIn{ from{opacity:0;} to{opacity:1;} }
    @keyframes slideInLeft{ from{opacity:0; transform: translateX(-30px);} to{opacity:1; transform: translateX(0);} }

    /* ===== HEADER (fixed) ===== */
    header{
      height:64px;
      padding:0 24px;
      border-bottom:1px solid var(--line);
      position:fixed;
      inset:0 0 auto 0;
      background: rgba(8,13,22,.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index:100;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:16px;
      animation: fadeIn .5s ease-out;
    }
    .headerLeft{ display:flex; align-items:center; gap:16px; min-width:0; }
    .logo{
      display:flex; align-items:center; gap:12px;
      text-decoration:none; color:var(--text);
      transition: transform .3s ease;
    }
    .logo:hover{ transform: scale(1.02); }
    .logo-icon{
      width:32px; height:32px;
      display:flex; align-items:center; justify-content:center;
      font-size:24px;
      filter: drop-shadow(0 0 10px rgba(56,189,248,.5));
    }
    .badge{
      font-size:10px;
      color:var(--text-muted);
      border:1px solid var(--line);
      padding:6px 12px;
      border-radius:999px;
      background: rgba(16,24,40,.5);
      backdrop-filter: blur(6px);
      display:inline-flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
    }
    .headerNav{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .headerNav a{
      color: var(--text-muted);
      text-decoration:none;
      font-weight:600;
      font-size:13px;
      border:1px solid var(--line);
      padding:8px 16px;
      border-radius:999px;
      background: rgba(16,24,40,.6);
      backdrop-filter: blur(8px);
      transition: all .3s ease;
      display:flex; align-items:center; gap:8px;
    }
    .headerNav a:hover{
      color: var(--text);
      background: rgba(30,58,95,.4);
      border-color: var(--line-light);
      transform: translateY(-2px);
    }
    .headerNav a.active{
      background: rgba(56,189,248,.15);
      border-color: rgba(56,189,248,.4);
      color: var(--ice);
      box-shadow: 0 0 20px rgba(56,189,248,.2);
    }
    .headerRight{ justify-self:end; }

    @media (max-width: 768px){
      header{ height:auto; grid-template-columns: 1fr; padding: 12px 16px; gap:12px; }
      .headerLeft{ justify-content:center; flex-wrap:wrap; }
      .headerRight{ display:none; }
    }

    /* ===== LAYOUT ===== */
    .wrap{
      padding-top:80px; /* header offset */
      max-width: 1200px;
      margin: 0 auto;
      padding: 80px 16px 16px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 16px;
      align-content:start;
      min-height:100vh;
    }

    /* ===== CARDS / UI ===== */
    .card{
      background: var(--gradient-card);
      border: 1px solid var(--line);
      border-radius: 20px;
      padding: 20px;
      overflow:hidden;
      position:relative;
      transition: all .4s ease;
      animation: fadeInUp .6s ease-out;
    }
    .card::before{
      content:'';
      position:absolute; inset:0;
      background: var(--gradient-aurora);
      opacity:0;
      transition: opacity .4s ease;
      pointer-events:none;
    }
    .card:hover::before{ opacity:1; }
    .card:hover{
      border-color: var(--glass-border);
      transform: translateY(-2px);
      box-shadow: var(--shadow-glow);
    }

    .title{
      font-size:14px;
      margin:0 0 8px 0;
      color: var(--snow);
      text-shadow: 0 0 20px rgba(240,249,255,.3);
      letter-spacing:1px;
    }
    .muted{ color: var(--text-muted); font-size: 13px; }
    .hint{ font-size:13px; color: var(--text-muted); line-height:1.5; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; align-items:center; }

    .pill{
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 14px;
      font-size:12px;
      color: var(--text-muted);
      background: rgba(16,24,40,.6);
      backdrop-filter: blur(8px);
      white-space:nowrap;
      transition: all .3s ease;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .pill:hover{ border-color: var(--line-light); background: rgba(30,58,95,.4); }
    .pill-ice{
      background: rgba(56,189,248,.12);
      border-color: rgba(56,189,248,.35);
      color: var(--ice);
    }
    .divider{
      height:1px;
      background: linear-gradient(90deg, transparent 0%, var(--line) 50%, transparent 100%);
      margin: 16px 0;
    }

    /* Inputs */
    .formGrid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 12px;
      position:relative;
      z-index:1;
    }
    .field{
      grid-column: span 6;
      display:flex;
      flex-direction:column;
      gap: 6px;
      min-width: 0;
    }
    @media (max-width: 720px){
      .field{ grid-column: span 12; }
    }
    .labelRow{
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      gap:10px;
    }
    .labelRow label{
      font-size: 13px;
      color: var(--text-muted);
      font-weight: 600;
    }
    .labelRow .mini{
      font-size: 12px;
      color: var(--text-dim);
    }

    input[type="number"], select, input[type="text"]{
      width:100%;
      border: 1px solid var(--line);
      background: rgba(16,24,40,.55);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 14px;
      outline:none;
      font-family: inherit;
      transition: all .25s ease;
    }
    input[type="number"]:focus, select:focus, input[type="text"]:focus{
      border-color: rgba(56,189,248,.55);
      box-shadow: 0 0 0 4px rgba(56,189,248,.10);
      background: rgba(16,24,40,.75);
    }
    select{ cursor:pointer; }

    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
      position:relative;
      z-index:1;
    }
    .btn{
      border: 1px solid rgba(56,189,248,.35);
      background: rgba(56,189,248,.14);
      color: var(--ice);
      padding: 12px 16px;
      border-radius: 14px;
      font-weight: 800;
      font-size: 13px;
      cursor:pointer;
      transition: all .25s ease;
      display:inline-flex;
      align-items:center;
      gap:10px;
      text-decoration:none;
      user-select:none;
    }
    .btn:hover{
      background: rgba(56,189,248,.22);
      border-color: rgba(56,189,248,.65);
      transform: translateY(-2px);
      box-shadow: 0 0 20px rgba(56,189,248,.25);
    }
    .btn.secondary{
      border: 1px solid var(--line);
      background: rgba(16,24,40,.55);
      color: var(--text-muted);
    }
    .btn.secondary:hover{
      background: rgba(30,58,95,.35);
      border-color: var(--line-light);
      color: var(--text);
      box-shadow: none;
    }

    /* Results */
    .resultGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
      position:relative;
      z-index:1;
    }
    @media (max-width: 900px){
      .resultGrid{ grid-template-columns: 1fr; }
    }
    .resultCard{
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 16px;
      background: rgba(16,24,40,.45);
      transition: all .3s ease;
    }
    .resultCard:hover{
      border-color: var(--line-light);
      background: rgba(30,58,95,.28);
      transform: translateY(-2px);
    }
    .resultTop{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
    }
    .resultTop b{ font-size: 14px; }
    .big{
      font-size: 28px;
      font-weight: 900;
      letter-spacing: .5px;
      margin-top: 10px;
    }
    .sub{
      margin-top: 6px;
      color: var(--text-muted);
      font-size: 12px;
      line-height: 1.4;
    }

    /* Gear list (same look as index items) */
    .filtersGrid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 12px;
      position:relative;
      z-index:1;
    }
    .filtersGrid .field{ grid-column: span 4; }
    @media (max-width: 900px){
      .filtersGrid .field{ grid-column: span 12; }
    }

    .item{
      display:grid;
      grid-template-columns: 100px 1fr 150px;
      gap: 16px;
      padding: 16px;
      border: 1px solid var(--line);
      border-radius: 16px;
      margin-top: 12px;
      align-items:center;
      transition: all .3s ease;
      background: rgba(16,24,40,.4);
      position:relative;
      z-index:1;
    }
    .item:hover{
      border-color: var(--line-light);
      background: rgba(30,58,95,.3);
      transform: translateX(4px);
    }
    @media (max-width: 720px){
      .item{ grid-template-columns: 1fr; text-align:center; }
      .thumb{ margin: 0 auto; }
      .item .cta{ justify-content:center; }
    }
    .thumb{
      width: 100px;
      height: 80px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(56,189,248,.05);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 28px;
      user-select:none;
    }
    .item h4{
      margin:0 0 6px 0;
      font-size: 14px;
      color: var(--text);
      font-weight: 700;
    }
    .metaLine{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 8px;
    }
    .stars{
      font-size: 12px;
      color: rgba(234,244,255,.85);
    }
    .cta{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 14px;
      background: rgba(56,189,248,.15);
      border: 1px solid rgba(56,189,248,.35);
      color: var(--ice);
      text-decoration:none;
      font-weight: 900;
      font-size: 13px;
      transition: all .3s ease;
      user-select:none;
    }
    .cta:hover{
      background: rgba(56,189,248,.25);
      border-color: var(--ice);
      transform: translateY(-2px);
      box-shadow: 0 0 20px rgba(56,189,248,.3);
    }
    .cta.disabled{
      opacity:.6;
      pointer-events:none;
      filter:saturate(.7);
    }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar{ width:8px; height:8px; }
    ::-webkit-scrollbar-track{ background: var(--bg-secondary); border-radius:4px; }
    ::-webkit-scrollbar-thumb{ background: var(--line); border-radius:4px; }
    ::-webkit-scrollbar-thumb:hover{ background: var(--ice); }

    /* Accessibility helpers */
    .sr-only{
      position:absolute !important;
      width:1px; height:1px;
      padding:0; margin:-1px;
      overflow:hidden;
      clip: rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
  </style>
</head>

<body>
  <div class="snowfall" id="snowfall" aria-hidden="true"></div>

  <header>
    <div class="headerLeft">
      <a class="logo" href="index.html"><span class="logo-icon">üèîÔ∏è</span><span style="font-weight:900;">Meow Meow Land</span></a>
      <div class="badge">Gear ‚Ä¢ calculator ‚Ä¢ affiliate-ready</div>
    </div>

    <nav class="headerNav" aria-label="Pages">
      <a href="index.html" data-page="home">üó∫Ô∏è Map</a>
      <a href="gear.html" data-page="gear">üéø Gear Finder</a>
    </nav>

    <div class="headerRight"></div>
  </header>

  <div class="wrap">

    <!-- CALCULATOR -->
    <section class="card" id="calcCard" style="animation-delay: .05s;">
      <h2 class="title font-pixel">GEAR CALCULATOR</h2>
      <div class="muted">Quick sizing hints for skis + snowboard based on height/weight + riding style. (Heuristic, not a substitute for shop fitting.)</div>

      <div class="formGrid" aria-label="Sizing inputs">
        <div class="field">
          <div class="labelRow">
            <label for="heightCm">Height (cm)</label>
            <span class="mini">e.g. 178</span>
          </div>
          <input id="heightCm" type="number" min="120" max="220" step="1" value="178" inputmode="numeric">
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="weightKg">Weight (kg)</label>
            <span class="mini">e.g. 75</span>
          </div>
          <input id="weightKg" type="number" min="35" max="150" step="1" value="75" inputmode="numeric">
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="ability">Ability</label>
            <span class="mini">controls length/flex</span>
          </div>
          <select id="ability">
            <option value="beginner">Beginner</option>
            <option value="intermediate" selected>Intermediate</option>
            <option value="advanced">Advanced</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="terrain">Terrain / style</label>
            <span class="mini">where you ride most</span>
          </div>
          <select id="terrain">
            <option value="allmountain" selected>All-mountain</option>
            <option value="piste">Mostly piste (groomers)</option>
            <option value="freeride">Freeride / powder</option>
            <option value="park">Park / freestyle</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="aggr">Riding feel</label>
            <span class="mini">relaxed vs aggressive</span>
          </div>
          <select id="aggr">
            <option value="relaxed">Relaxed</option>
            <option value="neutral" selected>Neutral</option>
            <option value="aggressive">Aggressive</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="boot">Boot size (EU) ‚Äî optional</label>
            <span class="mini">snowboard width hint</span>
          </div>
          <input id="boot" type="number" min="34" max="50" step="0.5" placeholder="e.g. 43">
        </div>
      </div>

      <div class="btnRow">
        <button class="btn" id="btnCalc" type="button">‚ú® Calculate</button>
        <button class="btn secondary" id="btnReset" type="button">‚Ü© Reset</button>
        <span class="pill" id="calcNote">Tip: tweak terrain to see different recommendations.</span>
      </div>

      <div class="divider"></div>

      <div class="resultGrid" id="resultGrid" aria-label="Sizing results">
        <!-- filled by JS -->
      </div>

      <div class="hint" style="margin-top:12px;">
        Notes: Ski sizing mostly follows ‚Äúheight-based with adjustments‚Äù. Snowboard sizing is mainly weight-based, then adjusted for style. Always check the brand‚Äôs size chart.
      </div>
    </section>

    <!-- GEAR SEARCH -->
    <section class="card" id="gearCard" style="animation-delay: .12s;">
      <h2 class="title font-pixel">RECOMMENDED GEAR</h2>
      <div class="muted">Filter items by category + price tier. Links are placeholders ‚Äî swap with your affiliate URLs later.</div>

      <div class="filtersGrid" aria-label="Gear filters">
        <div class="field">
          <div class="labelRow">
            <label for="q">Search</label>
            <span class="mini">brand/model/keyword</span>
          </div>
          <input id="q" type="text" placeholder="e.g. merino, gore-tex, helmet‚Ä¶">
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="cat">Category</label>
            <span class="mini">choose</span>
          </div>
          <select id="cat">
            <option value="all" selected>All categories</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="tier">Price</label>
            <span class="mini">‚Ç¨ / ‚Ç¨‚Ç¨ / ‚Ç¨‚Ç¨‚Ç¨</span>
          </div>
          <select id="tier">
            <option value="all" selected>All</option>
            <option value="‚Ç¨">‚Ç¨</option>
            <option value="‚Ç¨‚Ç¨">‚Ç¨‚Ç¨</option>
            <option value="‚Ç¨‚Ç¨‚Ç¨">‚Ç¨‚Ç¨‚Ç¨</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="minRating">Min rating</label>
            <span class="mini">demo field</span>
          </div>
          <select id="minRating">
            <option value="0" selected>Any</option>
            <option value="3">3+</option>
            <option value="4">4+</option>
            <option value="4.5">4.5+</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label for="sort">Sort</label>
            <span class="mini">useful for affiliate</span>
          </div>
          <select id="sort">
            <option value="reco" selected>Recommended</option>
            <option value="rating">Rating</option>
            <option value="priceAsc">Price tier ‚Üë</option>
            <option value="priceDesc">Price tier ‚Üì</option>
          </select>
        </div>

        <div class="field">
          <div class="labelRow">
            <label>&nbsp;</label>
            <span class="mini">actions</span>
          </div>
          <button class="btn secondary" id="btnClearFilters" type="button">üßπ Clear filters</button>
        </div>
      </div>

      <div class="divider"></div>

      <div class="row" style="margin-top:0;">
        <div class="pill pill-ice" id="countPill">0 items</div>
        <div class="pill" id="hintPill">Tip: keep data in JSON for fast load.</div>
      </div>

      <div id="gearList" aria-label="Gear list">
        <!-- filled by JS -->
      </div>

      <div class="divider"></div>

      <div class="hint">
        ‚ö†Ô∏è Disclaimer: Recommendations are generic and informational only. Always check compatibility (bindings/boots), safety standards (helmets), and local conditions.
      </div>
    </section>

    <!-- OPTIMIZATION + HOW TO FILL GEAR -->
    <section class="card" id="howCard" style="animation-delay: .18s;">
      <h2 class="title font-pixel">HOW TO ADD REAL PRODUCTS (OPTIMIZED)</h2>
      <div class="muted">Three good ways to keep this page fast, simple, and ‚ÄúGitHub Pages friendly‚Äù.</div>

      <div class="divider"></div>

      <div class="hint">
        <b>Option A (fastest MVP):</b> store products in <code>/data/gear.json</code> and load it with <code>fetch()</code>.<br/>
        You edit a single JSON file ‚Üí push to GitHub ‚Üí website updates. This is the most reliable for performance.
      </div>

      <div class="divider"></div>

      <div class="hint">
        <b>Option B (easy editing without server):</b> keep products in a Google Sheet and export as JSON via a tiny ‚Äúpublished‚Äù endpoint.<br/>
        Pros: you get an ‚Äúadmin-like‚Äù editor (Google Sheets). Cons: depends on Google availability; add caching.
      </div>

      <div class="divider"></div>

      <div class="hint">
        <b>Option C (real admin panel):</b> a headless CMS (e.g., Strapi/Directus) or Firebase/Supabase + an admin UI.<br/>
        Pros: login, edits, analytics dashboard integration. Cons: you need a backend (hosting), auth, and maintenance.
      </div>
    </section>

  </div>

  <script>
    // ===== Snowfall (visual only) =====
    function createSnowfall() {
      const container = document.getElementById('snowfall');
      if (!container) return;
      container.innerHTML = "";
      const count = 60;
      for (let i = 0; i < count; i++) {
        const flake = document.createElement('div');
        flake.className = 'snowflake';
        flake.style.left = Math.random() * 100 + '%';
        const size = (2 + Math.random() * 4);
        flake.style.width = size + 'px';
        flake.style.height = size + 'px';
        flake.style.animationDuration = (8 + Math.random() * 12) + 's';
        flake.style.animationDelay = (Math.random() * 10) + 's';
        flake.style.opacity = (0.25 + Math.random() * 0.65).toFixed(2);
        container.appendChild(flake);
      }
    }
    createSnowfall();

    // ===== Header nav active state =====
    (function () {
      const path = (location.pathname || "").toLowerCase();
      const isGear = path.endsWith("/gear.html") || path.endsWith("gear.html");
      const homeLink = document.querySelector('.headerNav a[data-page="home"]');
      const gearLink = document.querySelector('.headerNav a[data-page="gear"]');
      if (!homeLink || !gearLink) return;
      (isGear ? gearLink : homeLink).classList.add("active");
    })();

    // ===== Calculator logic (simple, explainable heuristics) =====
    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }
    function round5(x){ return Math.round(x / 5) * 5; }

    function skiLengthRange(heightCm, ability, terrain, aggr){
      // Baseline: ~90% of height (classic all-mountain starting point)
      let base = heightCm * 0.90;

      // Terrain adjustments
      // park: shorter; piste: slightly shorter; freeride: longer; all-mountain: neutral
      const terrAdj = {
        park: -8,
        piste: -3,
        allmountain: 0,
        freeride: +6
      }[terrain] ?? 0;

      // Ability adjustments
      const abilAdj = {
        beginner: -8,
        intermediate: 0,
        advanced: +6
      }[ability] ?? 0;

      // Aggression adjustments
      const aggrAdj = {
        relaxed: -3,
        neutral: 0,
        aggressive: +4
      }[aggr] ?? 0;

      let center = base + terrAdj + abilAdj + aggrAdj;
      center = clamp(center, heightCm - 25, heightCm + 10);

      // Range width
      const range = (ability === "beginner") ? 10 : (ability === "advanced") ? 12 : 10;
      const minLen = round5(center - range/2);
      const maxLen = round5(center + range/2);

      return { minLen, maxLen, center: round5(center) };
    }

    function skiType(terrain){
      if (terrain === "park") return "Freestyle / Twin-tip";
      if (terrain === "piste") return "Piste / Carving";
      if (terrain === "freeride") return "Freeride / Powder";
      return "All-mountain";
    }

    function snowboardLengthByWeight(weightKg){
      // Very rough weight ‚Üí length mapping (cm)
      // Typical sizing tables overlap; we output a range.
      // Reference-ish ranges, not brand-specific.
      if (weightKg < 45) return { min: 135, max: 145 };
      if (weightKg < 55) return { min: 140, max: 150 };
      if (weightKg < 65) return { min: 146, max: 155 };
      if (weightKg < 75) return { min: 150, max: 159 };
      if (weightKg < 85) return { min: 154, max: 162 };
      if (weightKg < 95) return { min: 158, max: 166 };
      return { min: 160, max: 170 };
    }

    function snowboardAdjust(range, terrain, ability, aggr){
      let min = range.min, max = range.max;

      // Park/freestyle: shorter, Freeride: longer
      if (terrain === "park") { min -= 3; max -= 3; }
      if (terrain === "piste") { min -= 1; max -= 1; }
      if (terrain === "freeride") { min += 3; max += 3; }

      // Beginner: shorter for control, Advanced/aggressive: longer for stability
      if (ability === "beginner") { min -= 2; max -= 2; }
      if (ability === "advanced") { min += 2; max += 2; }
      if (aggr === "aggressive") { min += 1; max += 1; }
      if (aggr === "relaxed") { min -= 1; max -= 1; }

      min = clamp(min, 130, 175);
      max = clamp(max, 132, 178);

      const center = round5((min + max) / 2);
      return { min: round5(min), max: round5(max), center };
    }

    function snowboardShape(terrain){
      if (terrain === "park") return "True twin / directional twin";
      if (terrain === "freeride") return "Directional (setback) / tapered";
      return "Directional twin / all-mountain";
    }

    function flexSuggestion(ability, terrain, aggr){
      // 1 (soft) .. 10 (stiff)
      let flex = 5;
      if (terrain === "park") flex -= 1;
      if (terrain === "freeride") flex += 1;
      if (ability === "beginner") flex -= 2;
      if (ability === "advanced") flex += 1;
      if (aggr === "aggressive") flex += 1;
      if (aggr === "relaxed") flex -= 1;
      flex = clamp(flex, 2, 8);
      const label = (flex <= 3) ? "Soft" : (flex <= 5) ? "Medium" : "Stiff-ish";
      return { flex, label };
    }

    function widthHint(bootEU){
      if (!bootEU || !isFinite(bootEU)) return "Width: standard (check boot chart)";
      if (bootEU >= 45) return "Width: Wide (for big boots)";
      if (bootEU >= 42.5) return "Width: Mid-wide / Wide depending on brand";
      return "Width: standard";
    }

    function renderResults(){
      const height = parseFloat(document.getElementById("heightCm").value);
      const weight = parseFloat(document.getElementById("weightKg").value);
      const ability = document.getElementById("ability").value;
      const terrain = document.getElementById("terrain").value;
      const aggr = document.getElementById("aggr").value;
      const boot = parseFloat(document.getElementById("boot").value);

      const grid = document.getElementById("resultGrid");

      if (!isFinite(height) || !isFinite(weight) || height < 120 || weight < 35){
        grid.innerHTML = `
          <div class="resultCard">
            <div class="muted">Please enter valid height + weight.</div>
          </div>
        `;
        return;
      }

      const ski = skiLengthRange(height, ability, terrain, aggr);
      const snowBase = snowboardLengthByWeight(weight);
      const board = snowboardAdjust(snowBase, terrain, ability, aggr);
      const flex = flexSuggestion(ability, terrain, aggr);

      const skiTxt = skiType(terrain);
      const boardShape = snowboardShape(terrain);
      const wHint = widthHint(boot);

      grid.innerHTML = `
        <div class="resultCard">
          <div class="resultTop">
            <div>
              <b>üéø Skis</b>
              <div class="sub">${skiTxt}</div>
            </div>
            <div class="pill pill-ice">${ability}</div>
          </div>

          <div class="big">${ski.minLen}‚Äì${ski.maxLen} cm</div>

          <div class="sub">
            Center: <b>${ski.center} cm</b><br/>
            Why: based on ~90% of height with style adjustments.<br/>
            Tip: if you like quick turns ‚Üí closer to ${ski.minLen}; stability ‚Üí closer to ${ski.maxLen}.
          </div>
        </div>

        <div class="resultCard">
          <div class="resultTop">
            <div>
              <b>üèÇ Snowboard</b>
              <div class="sub">${boardShape}</div>
            </div>
            <div class="pill pill-ice">${aggr}</div>
          </div>

          <div class="big">${board.min}‚Äì${board.max} cm</div>

          <div class="sub">
            Center: <b>${board.center} cm</b><br/>
            Flex: <b>${flex.label}</b> (${flex.flex}/10)<br/>
            ${wHint}
          </div>
        </div>
      `;
    }

    document.getElementById("btnCalc").addEventListener("click", renderResults);
    document.getElementById("btnReset").addEventListener("click", () => {
      document.getElementById("heightCm").value = 178;
      document.getElementById("weightKg").value = 75;
      document.getElementById("ability").value = "intermediate";
      document.getElementById("terrain").value = "allmountain";
      document.getElementById("aggr").value = "neutral";
      document.getElementById("boot").value = "";
      renderResults();
    });

    // Auto-calc on change (feels like a real calculator)
    ["heightCm","weightKg","ability","terrain","aggr","boot"].forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener("input", () => renderResults());
      el.addEventListener("change", () => renderResults());
    });

    // ===== Gear data (demo). Replace with /data/gear.json later. =====
    const GEAR = [
      { id:"ski-allmtn-1", title:"All-mountain skis (demo)", category:"Skis", priceTier:"‚Ç¨‚Ç¨", rating:4.4, emoji:"üéø", desc:"Versatile waist, stable on piste + okay in soft snow.", url:"#", reco: 10 },
      { id:"ski-freeride-1", title:"Freeride skis (demo)", category:"Skis", priceTier:"‚Ç¨‚Ç¨‚Ç¨", rating:4.6, emoji:"üèîÔ∏è", desc:"Wider platform for powder days & off-piste.", url:"#", reco: 9 },
      { id:"board-allmtn-1", title:"All-mountain snowboard (demo)", category:"Snowboards", priceTier:"‚Ç¨‚Ç¨", rating:4.5, emoji:"üèÇ", desc:"Directional twin for resort cruising + side hits.", url:"#", reco: 10 },
      { id:"board-park-1", title:"Park / freestyle board (demo)", category:"Snowboards", priceTier:"‚Ç¨", rating:4.2, emoji:"üõπ", desc:"Soft-medium flex for jibbing + learning spins.", url:"#", reco: 7 },

      { id:"boots-1", title:"Snowboard boots (demo)", category:"Boots", priceTier:"‚Ç¨‚Ç¨", rating:4.3, emoji:"ü•æ", desc:"Match flex to board. Good heel hold is key.", url:"#", reco: 8 },
      { id:"bindings-1", title:"Bindings (demo)", category:"Bindings", priceTier:"‚Ç¨‚Ç¨", rating:4.4, emoji:"üß∑", desc:"Medium flex bindings work for most riders.", url:"#", reco: 8 },

      { id:"helmet-1", title:"Helmet (MIPS style demo)", category:"Helmet", priceTier:"‚Ç¨‚Ç¨", rating:4.7, emoji:"‚õëÔ∏è", desc:"Priority purchase. Look for good fit + ventilation.", url:"#", reco: 10 },
      { id:"goggles-1", title:"Goggles (low-light lens demo)", category:"Goggles", priceTier:"‚Ç¨‚Ç¨", rating:4.5, emoji:"ü•Ω", desc:"Low-light lens helps in storms & flat light.", url:"#", reco: 9 },

      { id:"base-merino", title:"Merino base layer top (demo)", category:"Base layer", priceTier:"‚Ç¨‚Ç¨", rating:4.6, emoji:"üß•", desc:"Warm, breathable, doesn‚Äôt smell quickly.", url:"#", reco: 10 },
      { id:"mid-fleece", title:"Mid-layer fleece (demo)", category:"Mid layer", priceTier:"‚Ç¨", rating:4.2, emoji:"üß∂", desc:"Cheap warmth; great for resort and breaks.", url:"#", reco: 7 },
      { id:"shell-jacket", title:"Shell jacket (Gore-Tex style demo)", category:"Shell", priceTier:"‚Ç¨‚Ç¨‚Ç¨", rating:4.6, emoji:"üßä", desc:"Windproof + waterproof protection in storms.", url:"#", reco: 9 },
      { id:"gloves-warm", title:"Warm gloves (demo)", category:"Gloves", priceTier:"‚Ç¨", rating:4.1, emoji:"üß§", desc:"Bring warmer gloves if you get cold easily.", url:"#", reco: 7 },
      { id:"socks-merino", title:"Merino ski socks (demo)", category:"Socks", priceTier:"‚Ç¨", rating:4.5, emoji:"üß¶", desc:"No wrinkles; avoid doubling socks.", url:"#", reco: 8 },
    ];

    const PRICE_ORDER = { "‚Ç¨": 1, "‚Ç¨‚Ç¨": 2, "‚Ç¨‚Ç¨‚Ç¨": 3 };

    function unique(arr){ return [...new Set(arr)]; }

    function stars(r){
      if (!r) return "";
      const full = Math.floor(r);
      const half = (r - full) >= 0.5 ? 1 : 0;
      const empty = 5 - full - half;
      return "‚òÖ".repeat(full) + (half ? "¬Ω" : "") + "‚òÜ".repeat(Math.max(0, empty));
    }

    function ensureCategoryOptions(){
      const sel = document.getElementById("cat");
      const cats = unique(GEAR.map(g => g.category)).sort((a,b) => a.localeCompare(b));
      const opts = ['<option value="all" selected>All categories</option>']
        .concat(cats.map(c => `<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`));
      sel.innerHTML = opts.join("");
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function applyFilters(){
      const q = (document.getElementById("q").value || "").trim().toLowerCase();
      const cat = document.getElementById("cat").value;
      const tier = document.getElementById("tier").value;
      const minRating = parseFloat(document.getElementById("minRating").value || "0");
      const sort = document.getElementById("sort").value;

      let out = GEAR.slice();

      if (q){
        out = out.filter(it => {
          const hay = `${it.title} ${it.desc} ${it.category}`.toLowerCase();
          return hay.includes(q);
        });
      }
      if (cat !== "all") out = out.filter(it => it.category === cat);
      if (tier !== "all") out = out.filter(it => it.priceTier === tier);
      if (minRating > 0) out = out.filter(it => (it.rating || 0) >= minRating);

      // sorting
      if (sort === "rating"){
        out.sort((a,b) => (b.rating||0) - (a.rating||0));
      } else if (sort === "priceAsc"){
        out.sort((a,b) => (PRICE_ORDER[a.priceTier]||99) - (PRICE_ORDER[b.priceTier]||99));
      } else if (sort === "priceDesc"){
        out.sort((a,b) => (PRICE_ORDER[b.priceTier]||0) - (PRICE_ORDER[a.priceTier]||0));
      } else {
        // recommended
        out.sort((a,b) => (b.reco||0) - (a.reco||0));
      }

      renderGear(out);
    }

    function renderGear(items){
      const list = document.getElementById("gearList");
      const count = document.getElementById("countPill");

      count.textContent = `${items.length} item${items.length === 1 ? "" : "s"}`;

      if (!items.length){
        list.innerHTML = `
          <div class="resultCard" style="margin-top:12px;">
            <b>No matches.</b>
            <div class="sub">Try removing filters or using fewer keywords.</div>
          </div>
        `;
        return;
      }

      list.innerHTML = items.map(it => {
        const url = it.url || "#";
        const disabled = (url === "#") ? "disabled" : "";
        const rating = (typeof it.rating === "number") ? it.rating.toFixed(1) : "‚Äî";
        return `
          <div class="item">
            <div class="thumb" aria-hidden="true">${escapeHtml(it.emoji || "‚ùÑÔ∏è")}</div>
            <div>
              <h4>${escapeHtml(it.title)}</h4>
              <div class="muted">${escapeHtml(it.desc || "")}</div>
              <div class="metaLine">
                <span class="pill">${escapeHtml(it.category)}</span>
                <span class="pill">${escapeHtml(it.priceTier || "‚Ç¨")}</span>
                <span class="pill">‚≠ê ${rating}</span>
                <span class="stars">${escapeHtml(stars(it.rating || 0))}</span>
              </div>
            </div>
            <a class="cta ${disabled}" href="${escapeHtml(url)}" target="_blank" rel="noopener noreferrer">
              View ‚Üí
            </a>
          </div>
        `;
      }).join("");
    }

    document.getElementById("btnClearFilters").addEventListener("click", () => {
      document.getElementById("q").value = "";
      document.getElementById("cat").value = "all";
      document.getElementById("tier").value = "all";
      document.getElementById("minRating").value = "0";
      document.getElementById("sort").value = "reco";
      applyFilters();
    });

    ["q","cat","tier","minRating","sort"].forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener("input", applyFilters);
      el.addEventListener("change", applyFilters);
    });

    // ===== Init =====
    ensureCategoryOptions();
    renderResults();
    applyFilters();
  </script>
</body>
</html>

